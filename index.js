let fs=require("fs");const{resolve}=require("path");const{red,green,cyan,bgRed,bgGreen,bgCyan}=require("chalk");module.exports=function create(options){const{name,template}=options;const model=template||'vanilla-frontend';const src=resolve(__dirname,"__templates",model);const dist=resolve(process.cwd(),name);const translations={'pt':{rootFolder:'pasta-raiz: '+name,blueFolder:'pastas',greenFile:'arquivos'},'en':{rootFolder:'root-folder: '+name,blueFolder:'folders',greenFile:'files'}};if(fs.existsSync(dist)){console.log(red(`The target directory exists.\n${dist}`));return process.exit(1);}function copyDirRecursive(src,dest){fs.mkdirSync(dest);fs.readdirSync(src).forEach(file=>{const srcPath=resolve(src,file);const destPath=resolve(dest,file);const isDirectory=fs.statSync(srcPath).isDirectory();if(isDirectory){copyDirRecursive(srcPath,destPath);}else{fs.copyFileSync(srcPath,destPath);}});}copyDirRecursive(src,dist);process.stdout.write('\u001B[2J\u001B[0;0f');console.log(`${dist} Generated.`);tree(dist,true);console.log('\n');console.log('Legenda: ' + '/' +' captions');console.log(bgRed('~\\') + " - " + translations[global.language].rootFolder + "\u200B");console.log(bgCyan('/') + " - " + translations[global.language].blueFolder + "\u200B");console.log(bgGreen('.') + " - " + translations[global.language].greenFile + "\u200B");updateHTMLTitles(dist,name);};function tree(path,isRoot=false,prefix=''){const files=fs.readdirSync(path);if(isRoot){console.log(red('~\\'+path.split('\\').pop()));}files.forEach((name,i,{length})=>{const isLast=i===length-1;const fullPath=resolve(path,name);const stat=fs.statSync(fullPath);if(stat.isDirectory()){console.log(prefix+(isLast?'└── ':'├── ')+cyan(name+'/'));tree(fullPath,false,prefix+(isLast?'    ':'|   '));}else{console.log(prefix+(isLast?'└── ':'├── ')+green('.'+name));}});}function updateHTMLTitles(dist,projectName){const htmlFiles=getHTMLFiles(dist);htmlFiles.forEach(file=>{const filePath=resolve(dist,file);let content=fs.readFileSync(filePath,'utf8');content=content.replace(/<title>(.*?)<\/title>/g,`<title>${projectName}</title>`);fs.writeFileSync(filePath,content,'utf8');});}function getHTMLFiles(dir){const files=fs.readdirSync(dir);const htmlFiles=files.filter(file=>/\.html$/.test(file));return htmlFiles;}
